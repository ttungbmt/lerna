{"version":3,"file":"bundlers.rollup.es.js","sources":["../src/env.js","../src/externalPkg.js","../src/getPlugins.js"],"sourcesContent":["export const prod = !process.env.ROLLUP_WATCH","import { filter, includes, isString, reject } from 'lodash'\r\nimport peerDepsExternal from 'rollup-plugin-peer-deps-external';\r\nimport readPkg from 'read-pkg'\r\n\r\nconst pkg = readPkg.sync()\r\n\r\nexport default function externalPkg({external} = {}) {\r\n    if (!external) return []\r\n\r\n    if (isString(external)) {\r\n\r\n        if (external === 'all') {\r\n            return [\r\n                peerDepsExternal({\r\n                    includeDependencies: true,\r\n                }),\r\n            ]\r\n        }\r\n    }\r\n\r\n    return [\r\n        (() => ({\r\n            name: 'external',\r\n            options: opts => {\r\n                let ids = [],\r\n                    fn = external ? filter : reject\r\n                ids = ids.concat(Object.keys(pkg.devDependencies), Object.keys(pkg.dependencies))\r\n                opts.external = id => fn(ids, o => includes(external, o)).some(module => module === id)\r\n\r\n                return opts\r\n            }\r\n        }))(),\r\n        peerDepsExternal({\r\n            includeDependencies: false,\r\n        }),\r\n    ]\r\n}","import commonjs from '@rollup/plugin-commonjs';\r\nimport aliasPlugin from 'rollup-plugin-alias';\r\nimport postcss from 'rollup-plugin-postcss'\r\nimport babel from 'rollup-plugin-babel';\r\nimport vue from 'rollup-plugin-vue'\r\nimport resolve from '@rollup/plugin-node-resolve';\r\nimport replace from '@rollup/plugin-replace'\r\nimport progress from 'rollup-plugin-progress';\r\nimport filesize from 'rollup-plugin-filesize';\r\nimport url from '@rollup/plugin-url';\r\nimport svgr from '@svgr/rollup'\r\nimport json from '@rollup/plugin-json';\r\nimport { reject, includes, isString, filter } from 'lodash'\r\nimport serve from 'rollup-plugin-serve'\r\nimport livereload from 'rollup-plugin-livereload'\r\nimport { terser } from 'rollup-plugin-terser';\r\nimport path from 'path'\r\nimport { appSrc } from 'react-scripts/config/paths'\r\n\r\nimport externalPkg from './externalPkg'\r\nimport { prod } from './env'\r\n\r\n/*\r\n@rollup/plugin-legacy\r\n@rollup/plugin-multi-entry\r\n@rollup/plugin-node-resolve\r\n*/\r\n\r\nexport default function getPlugins(params = {}) {\r\n    const {external, alias, minify, hot} = params\r\n\r\n    return [\r\n        ...externalPkg({external}),\r\n        svgr(),\r\n        json(),\r\n        url(),\r\n        postcss({\r\n            extract: true,\r\n            plugins: [],\r\n            minimize: true,\r\n            sourceMap: true,\r\n        }),\r\n        vue({\r\n            css: false\r\n        }),\r\n        replace({\r\n            'process.env.NODE_ENV': prod\r\n                ? JSON.stringify('production')\r\n                : JSON.stringify('development'),\r\n        }),\r\n        resolve({\r\n            browser: true,\r\n        }),\r\n        babel({\r\n            presets: [\r\n                ['@babel/preset-env', {modules: false}],\r\n                '@babel/preset-react',\r\n                '@babel/preset-flow',\r\n            ],\r\n            plugins: [\r\n                '@babel/plugin-proposal-export-default-from',\r\n                '@babel/plugin-proposal-export-namespace-from',\r\n                '@babel/plugin-proposal-throw-expressions',\r\n                '@babel/plugin-proposal-class-properties',\r\n                '@babel/plugin-syntax-dynamic-import',\r\n                '@babel/plugin-proposal-object-rest-spread',\r\n                '@babel/plugin-proposal-optional-chaining',\r\n                ['@babel/plugin-proposal-decorators', {'legacy': true}],\r\n            ],\r\n            exclude: 'node_modules/**',\r\n            runtimeHelpers: true,\r\n        }),\r\n        commonjs(),\r\n        aliasPlugin({\r\n            entries: {\r\n                '@': path.resolve(appSrc),\r\n                ...alias,\r\n            }\r\n        }),\r\n        progress(),\r\n        filesize(),\r\n        hot && livereload('dist'),\r\n        // serve({\r\n        //     open: true,\r\n        //     contentBase: ['dist'],\r\n        //     port: 5000,\r\n        // }),\r\n        minify && terser(),\r\n    ]\r\n}\r\n"],"names":[],"mappings":"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"}